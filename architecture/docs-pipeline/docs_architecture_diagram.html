<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>docs_architecture_diagram - StockEase Frontend Docs</title>
  <!-- Will be set to a repo-relative path at runtime -->
  <link rel="stylesheet" href="/frontend/templates/frontend-docs.css">
</head>
<body>
  <header>
    <div class="header-content">
      <a id="home-link" href="#" class="logo">üìö StockEase Frontend Docs</a>
      <nav class="nav-breadcrumb">
        <a id="home-crumb" href="#">Home</a> / <span id="breadcrumb">Documentation</span>
      </nav>
    </div>
  </header>

  <div class="container">
    <aside id="sidebar"></aside>
    <main>
      <div class="content">
        <h1 id="documentation-pipeline-architecture">Documentation
        Pipeline Architecture</h1>
        <h2 id="system-overview">System Overview</h2>
        <div class="mermaid">
        graph TD
            subgraph main["MAIN BRANCH (Source of Truth)"]
                direction LR
                subgraph committed["‚úì Committed"]
                    src["src/"]
                    docs["docs/"]
                    scripts["scripts/build-arch-docs.sh"]
                    configs["package.json<br/>typedoc.json<br/>vitest.config.ts<br/>.github/workflows/<br/>.dockerignore<br/>.gitignore<br/>Dockerfile<br/>README.md"]
                end
                
                subgraph generated["‚úó Not Committed (gitignore)"]
                    dist["dist/ (Vite build)"]
                    coverage["coverage/ (Test coverage)"]
                    publicdocs["public-docs/ (Generated docs)"]
                    nodemodules["node_modules/"]
                end
                
                subgraph generated2["Generated by npm run docs:all"]
                    publicdocs2["public-docs/index.html<br/>public-docs/architecture/*.html<br/>public-docs/typedoc/<br/>public-docs/coverage/<br/>public-docs/templates/*.css"]
                end
            end
            
            main --> deploy["deploy-frontend.yml"]
            main --> docspipe["docs-pipeline.yml"]
            
            deploy --> vercel["VERCEL PRODUCTION<br/>https://stockease-...vercel.app/"]
            docspipe --> ghpages["GITHUB PAGES gh-pages<br/>https://keglev.github.io/stockease-frontend/"]
            
            vercel --> vContent["‚úì dist/ production app<br/>‚úó .md files<br/>‚úó Test files<br/>‚úó Documentation source"]
            ghpages --> ghContent["‚úì public-docs/index.html<br/>‚úì Architecture HTML<br/>‚úì TypeDoc API<br/>‚úì Coverage reports<br/>‚úó Source files<br/>‚úó node_modules"]
            
            style main fill:#e1f5ff
            style vercel fill:#c8e6c9
            style ghpages fill:#fff9c4
            style vContent fill:#c8e6c9
            style ghContent fill:#fff9c4
        </div>
        <hr />
        <h2 id="file-generation-pipeline">File Generation Pipeline</h2>
        <div class="mermaid">
        graph TD
            docall["npm run docs:all"]
            
            docall --> clean["npm run docs:clean"]
            docall --> arch["npm run docs:arch"]
            docall --> typedoc["npm run docs:typedoc"]
            docall --> coverage["npm run docs:coverage"]
            docall --> landing["npm run docs:landing"]
            
            clean --> cleanout["Remove public-docs<br/>Create public-docs/<br/>‚îú‚îÄ‚îÄ architecture/<br/>‚îú‚îÄ‚îÄ typedoc/<br/>‚îî‚îÄ‚îÄ coverage/"]
            
            arch --> archconv["Pandoc<br/>Converts markdown ‚Üí HTML<br/>Uses template<br/>Applies CSS<br/>Adds TOC"]
            archconv --> archout["Output:<br/>public-docs/architecture/"]
            
            typedoc --> typedocconv["TypeDoc<br/>Generates from source code<br/>‚îú‚îÄ‚îÄ index.html<br/>‚îú‚îÄ‚îÄ Search<br/>‚îú‚îÄ‚îÄ API docs<br/>‚îî‚îÄ‚îÄ Modules"]
            typedocconv --> typedocout["Output:<br/>public-docs/typedoc/"]
            
            coverage --> covconv["Vitest<br/>Generates coverage report<br/>‚îú‚îÄ‚îÄ index.html<br/>‚îî‚îÄ‚îÄ Coverage data"]
            covconv --> covout["Output:<br/>public-docs/coverage/"]
            
            landing --> landingconv["Node.js<br/>Converts docs/index.md ‚Üí index.html<br/>Uses template + CSS<br/>Creates landing page"]
            landingconv --> landingout["Output:<br/>public-docs/index.html"]
            
            cleanout --> final["public-docs/ Final Output<br/>‚îú‚îÄ‚îÄ index.html<br/>‚îú‚îÄ‚îÄ architecture/ (all sections)<br/>‚îú‚îÄ‚îÄ typedoc/ (API docs)<br/>‚îú‚îÄ‚îÄ coverage/ (test reports)<br/>‚îî‚îÄ‚îÄ templates/ (CSS)"]
            
            archout --> final
            typedocout --> final
            covout --> final
            landingout --> final
            
            final --> ghpages["Publish to gh-pages<br/>via peaceiris/actions-gh-pages@v3"]
            
            ghpages --> deployed["GitHub Pages<br/>https://keglev.github.io/stockease-frontend/"]
            
            style docall fill:#bbdefb
            style final fill:#c8e6c9
            style deployed fill:#fff9c4
        </div>
        <hr />
        <h2 id="workflow-decision-tree">Workflow Decision Tree</h2>
        <div class="mermaid">
        graph TD
            push["Push to main"]
            
            push --> checkdeploy["deploy-frontend.yml<br/>Always runs<br/>Irrelevant of paths"]
            push --> checkdocs["docs-pipeline.yml<br/>Conditional path-based"]
            
            checkdeploy --> deploy1["1. Test npm test"]
            deploy1 --> deploy2["2. Build npm run build"]
            deploy2 --> deploy3["3. Docker verify"]
            deploy3 --> deploy4["4. Deploy to Vercel"]
            deploy4 --> deployout["Output: dist/ ‚Üí Vercel<br/>Duration: 3-5 minutes"]
            
            checkdocs --> fileschanged{{"Changed files<br/>include:<br/>docs/**<br/>src/**<br/>*.json config<br/>vitest.config.ts"}}
            
            fileschanged -->|YES| docsbuild["1. Build arch docs<br/>2. Generate TypeDoc<br/>3. Generate coverage<br/>4. Build landing page<br/>5. Publish to gh-pages"]
            fileschanged -->|NO| docsskip["SKIP"]
            
            docsbuild --> docsout["Output: public-docs/ ‚Üí gh-pages<br/>Duration: 2-4 minutes"]
            
            style push fill:#bbdefb
            style deployout fill:#c8e6c9
            style docsout fill:#fff9c4
            style docsskip fill:#ffccbc
        </div>
        <hr />
        <h2 id="security--isolation">Security &amp; Isolation</h2>
        <div class="mermaid">
        graph LR
            subgraph prod["Production Pipeline deploy-frontend.yml"]
                p1["Input:<br/>main branch<br/>complete source"]
                p2[".dockerignore<br/>excludes:<br/>docs/<br/>*.md<br/>**/__tests__<br/>.github/<br/>Coverage files"]
                p3["Docker copies:<br/>src/<br/>public/<br/>config files only"]
                p4["Builds:<br/>dist/<br/>production bundle"]
                p5["Result:<br/>Lean image<br/>no docs"]
                p6["Deployed to:<br/>Vercel"]
            end
            
            subgraph doc["Documentation Pipeline docs-pipeline.yml"]
                d1["Input:<br/>main branch<br/>only when relevant<br/>files change"]
                d2["Generates:<br/>public-docs/<br/>temporary"]
                d3["Runs:<br/>npm run docs:all<br/>Pandoc markdown‚ÜíHTML<br/>TypeDoc source‚ÜíAPI docs<br/>Vitest coverage‚Üíreports<br/>Landing index.md‚ÜíHTML"]
                d4["Publishes:<br/>public-docs/‚Üígh-pages<br/>only"]
                d5["Result:<br/>Clean documentation<br/>site"]
                d6["Served at:<br/>GitHub Pages"]
            end
            
            subgraph results["Separation Results"]
                r1["‚úÖ No docs in production"]
                r2["‚úÖ No code in docs"]
                r3["‚úÖ Different deployment"]
                r4["‚úÖ Different builds"]
                r5["‚úÖ Different access"]
            end
            
            p1 --> p2 --> p3 --> p4 --> p5 --> p6
            d1 --> d2 --> d3 --> d4 --> d5 --> d6
            p6 --> results
            d6 --> results
            
            style prod fill:#c8e6c9
            style doc fill:#fff9c4
            style results fill:#e1bee7
        </div>
        <hr />
        <h2 id="caching--performance">Caching &amp; Performance</h2>
        <div class="mermaid">
        graph TD
            subgraph browser["Client Browser"]
                b1["Landing page:<br/>No cache<br/>checks for updates"]
                b2["Architecture pages:<br/>Browser cache<br/>mostly static"]
                b3["TypeDoc pages:<br/>Browser cache<br/>generated once<br/>per src change"]
                b4["Coverage pages:<br/>Browser cache<br/>generated per<br/>test run"]
                b5["Static assets CSS JS:<br/>Pandoc-generated CSS<br/>Browser cache<br/>Mermaid.js CDN:<br/>CDN cache"]
            end
            
            subgraph github["GitHub Pages"]
                g1["Serves static<br/>HTML directly"]
                g2["Uses HTTP/2"]
                g3["GZIP compression<br/>enabled"]
                g4["CDN caching<br/>Cloudflare"]
                g5["Edge locations<br/>worldwide"]
            end
            
            subgraph vercel["Production Vercel"]
                v1["React app:<br/>Dynamic<br/>Next.js-like behavior"]
                v2["Static files:<br/>Vercel edge cache"]
                v3["API proxying:<br/>Dynamic<br/>to backend"]
                v4["Auto-scaling:<br/>Serverless functions"]
            end
            
            style browser fill:#c8e6c9
            style github fill:#fff9c4
            style vercel fill:#f8bbd0
        </div>
        <hr />
        <h2 id="change-detection-logic">Change Detection Logic</h2>
        <h3 id="docs-pipelineyml-triggers-when">docs-pipeline.yml
        triggers when:</h3>
        <table>
        <thead>
        <tr class="header">
        <th>Trigger</th>
        <th>Action</th>
        <th>Result</th>
        </tr>
        </thead>
        <tbody>
        <tr class="odd">
        <td><code>docs/architecture/*.md</code> changed</td>
        <td>‚úÖ Rebuild architecture HTML</td>
        <td>Docs updated</td>
        </tr>
        <tr class="even">
        <td><code>src/*.ts</code> or <code>src/*.tsx</code> changed</td>
        <td>‚úÖ Regenerate TypeDoc</td>
        <td>API docs updated</td>
        </tr>
        <tr class="odd">
        <td><code>vitest.config.ts</code> changed</td>
        <td>‚úÖ Rebuild with new config</td>
        <td>Coverage updated</td>
        </tr>
        <tr class="even">
        <td><code>typedoc.json</code> changed</td>
        <td>‚úÖ Rebuild with new config</td>
        <td>API docs updated</td>
        </tr>
        <tr class="odd">
        <td><code>package.json</code> or <code>package-lock.json</code>
        changed</td>
        <td>‚úÖ Rebuild</td>
        <td>Dependencies may affect docs</td>
        </tr>
        <tr class="even">
        <td>Only tests changed <code>*.test.ts</code></td>
        <td>‚è≠Ô∏è SKIPPED</td>
        <td>No docs rebuild needed</td>
        </tr>
        <tr class="odd">
        <td>Only linting changed <code>.eslintrc</code></td>
        <td>‚è≠Ô∏è SKIPPED</td>
        <td>No docs rebuild needed</td>
        </tr>
        <tr class="even">
        <td>Only production code <code>src/main.tsx</code></td>
        <td>‚è≠Ô∏è SKIPPED</td>
        <td>No docs rebuild needed</td>
        </tr>
        <tr class="odd">
        <td>Only workflows changed</td>
        <td>‚è≠Ô∏è SKIPPED</td>
        <td>No docs rebuild needed</td>
        </tr>
        </tbody>
        </table>
        <p>This prevents unnecessary documentation rebuilds when they're
        not needed.</p>
        <hr />
        <h2 id="link-resolution-logic">Link Resolution Logic</h2>
        <p>Generated HTML uses JavaScript to resolve paths
        dynamically:</p>
        <div class="sourceCode" id="cb1"><pre
        class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getRootFrom</span>(pathname) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Example paths:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// /stockease-frontend/index.html</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   ‚Üí root = ./</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// /stockease-frontend/architecture/overview.html</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   ‚Üí root = ../</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// /stockease-frontend/architecture/api/overview.html</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   ‚Üí root = ../../</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Works under any subdomain:</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// https://keglev.github.io/stockease-frontend/ ‚úÖ</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// https://custom.com/docs/stockease/ ‚úÖ</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">// https://docs.stockease.example.com/ ‚úÖ</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="bu">CSS</span> Path<span class="op">:</span> ${<span class="bu">root</span>} <span class="op">+</span> templates<span class="op">/</span>frontend<span class="op">-</span>docs<span class="op">.</span><span class="at">css</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>Home Link<span class="op">:</span> ${<span class="bu">root</span>} <span class="op">+</span> index<span class="op">.</span><span class="at">html</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>API Link<span class="op">:</span> ${<span class="bu">root</span>} <span class="op">+</span> typedoc<span class="op">/</span>index<span class="op">.</span><span class="at">html</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>Coverage Link<span class="op">:</span> ${<span class="bu">root</span>} <span class="op">+</span> coverage<span class="op">/</span>index<span class="op">.</span><span class="at">html</span></span></code></pre></div>
        <hr />
        <h2 id="summary">Summary</h2>
        <p>This architecture provides:</p>
        <p>‚úÖ <strong>Complete Separation</strong>: Docs and production
        never mix<br />
        ‚úÖ <strong>Automated Generation</strong>: All docs built on
        every relevant change<br />
        ‚úÖ <strong>Targeted Triggers</strong>: Only runs when
        needed<br />
        ‚úÖ <strong>Clean Distribution</strong>: Each system gets exactly
        what it needs<br />
        ‚úÖ <strong>Security</strong>: No documentation in production
        code<br />
        ‚úÖ <strong>Performance</strong>: Lean images, efficient
        pipelines<br />
        ‚úÖ <strong>Scalability</strong>: GitHub Pages handles docs,
        Vercel handles app<br />
        ‚úÖ <strong>Maintenance</strong>: Single source of truth (main
        branch)</p>
        <hr />
        <p>Generated: November 12, 2025</p>
      </div>
    </main>
  </div>

  <footer>
    <div class="footer-content">
      <p><strong>StockEase</strong> - Inventory Management System</p>
      <p>Architecture Documentation | Frontend</p>
      <p style="opacity:.7;font-size:.85rem;">¬© 2025 Team StockEase. All rights reserved.</p>
    </div>
  </footer>

  <script>
    // Absolute base for the site on GitHub Pages
    const BASE = '/frontend/';

    // Sidebar (frontend-focused). Keep hrefs relative to 'architecture/' except where absolute noted.
    const navigation = {
      'Frontend Docs': [
        { label: 'Landing', href: 'index.html', isRoot: true },
        { label: 'Architecture Index', href: 'index.html' },
        { label: 'Overview', href: 'overview.html' },
        { label: '√úbersicht (Deutsch)', href: 'overview.de.html' },
        { label: 'Docs Pipeline', href: 'docs-pipeline/overview.html' },
        { label: 'Production Pipeline', href: 'pipeline/overview.html' },
      ],
      'Sections': [
        { label: 'API Layer', href: 'src/api/overview.html' },
        { label: 'Components', href: 'src/components/overview.html' },
        { label: 'Security', href: 'src/security/overview.html' },
        { label: 'Pages', href: 'src/pages/overview.html' },
        { label: 'Services', href: 'src/services/overview.html' },
        { label: 'Localization (i18n)', href: 'src/i18n/overview.html' },
        { label: 'Docker Setup', href: 'src/docker_structure/overview.html' },
        { label: 'Testing', href: 'src/tests/overview.html' },
      ],
      'Generated': [
        // Use absolute internal paths so they always resolve with CSS
        { label: 'TypeDoc (TS API)', href: '/frontend/typedoc/index.html', absolute: true },
        { label: 'Coverage (Vitest)', href: '/frontend/coverage/index.html', absolute: true },
      ],
      'Backend (external)': [
        { label: 'Backend Docs', href: 'https://keglev.github.io/stockease/', external: true },
        { label: 'Backend API (ReDoc)', href: 'https://keglev.github.io/stockease/api-docs.html', external: true },
        { label: 'Backend Coverage', href: 'https://keglev.github.io/stockease/coverage/', external: true },
      ],
    };

    // Set header links to the site root
    document.addEventListener('DOMContentLoaded', () => {
      const home = BASE + 'index.html';
      const homeLink = document.getElementById('home-link');
      const homeCrumb = document.getElementById('home-crumb');
      if (homeLink) homeLink.href = home;
      if (homeCrumb) homeCrumb.href = home;
    });

    function buildSidebar() {
      const sidebar = document.getElementById('sidebar');
      if (!sidebar) return;

      Object.entries(navigation).forEach(([section, links]) => {
        const block = document.createElement('div');
        block.className = 'nav-section';

        const title = document.createElement('div');
        title.className = 'nav-section-title';
        title.textContent = section;
        block.appendChild(title);

        const ul = document.createElement('ul');
        links.forEach(link => {
          const li = document.createElement('li');
          const a = document.createElement('a');

          if (link.external || link.absolute) {
            // external http(s) OR absolute internal '/frontend/...'
            a.href = link.href;
          } else if (link.isRoot) {
            a.href = BASE + 'index.html';
          } else if (link.isCoverage) {
            a.href = BASE + 'coverage/index.html';
          } else if (link.isApiDoc) {
            a.href = BASE + 'api-docs.html';
          } else {
            // default: architecture-relative
            a.href = BASE + 'architecture/' + link.href;
          }

          a.textContent = link.label;

          // Active-state highlight
          const current = window.location.pathname;
          const linkPath = a.pathname.replace(/\.html$/, '');
          if (current.endsWith(a.pathname) || current.includes(linkPath)) {
            a.className = 'active';
          }

          li.appendChild(a);
          ul.appendChild(li);
        });

        block.appendChild(ul);
        sidebar.appendChild(block);
      });
    }

    document.addEventListener('DOMContentLoaded', buildSidebar);
  </script>

  <!-- Mermaid.js for diagrams -->
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({
      startOnLoad: false,
      theme: 'default',
      securityLevel: 'loose',
      fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
    });

    // Convert fenced code blocks emitted by Pandoc to <div class="mermaid"> sources
    const blocks = document.querySelectorAll('code.language-mermaid');
    blocks.forEach(code => {
      code.classList.remove('language-mermaid');
      code.classList.add('mermaid');
      if (code.parentElement.tagName === 'PRE') {
        code.parentElement.classList.add('mermaid-block');
      }
    });

    // Render all diagrams
    (document.readyState === 'loading'
      ? new Promise(r => document.addEventListener('DOMContentLoaded', r))
      : Promise.resolve()
    ).then(() => mermaid.run()).catch(err => console.error('Mermaid rendering error:', err));
  </script>
</body>
</html>
